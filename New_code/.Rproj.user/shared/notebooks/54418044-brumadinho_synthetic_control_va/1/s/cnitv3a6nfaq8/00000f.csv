"0","# Ensure all elements are data.frames and have identical columns"
"0","placebo_results_clean <- placebo_results[sapply(placebo_results, is.data.frame)]"
"0",""
"0","# Get full set of columns"
"0","all_cols <- Reduce(union, lapply(placebo_results_clean, names))"
"0",""
"0","# Add missing columns as NA to each data.frame"
"0","placebo_results_clean <- lapply(placebo_results_clean, function(df) {"
"0","  missing_cols <- setdiff(all_cols, names(df))"
"0","  for (col in missing_cols) df[[col]] <- NA"
"0","  df[all_cols]"
"0","})"
"0",""
"0","# Combine"
"0","placebo_df <- do.call(rbind, placebo_results_clean)"
"0",""
"0","good_units <- rmspe_stats$COD_MUN[rmspe_stats$pre_rmspe <= 5 * treated_pre_rmspe]"
"0","placebo_df_filtered <- subset(placebo_df, COD_MUN %in% good_units)"
"0","rmspe_stats_filtered <- subset(rmspe_stats, COD_MUN %in% good_units)"
"0","length(good_units)"
"1","[1]"
"1"," 22"
"1","
"
